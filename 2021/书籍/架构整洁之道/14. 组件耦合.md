## 组件耦合

### 无依赖环原则
> 组件依赖关系图中不应该出现环

### 打破循环依赖
1. 应用依赖反转原则(DIP)
2. 创建一个新的组件,将现有的这两个组件中互相依赖的类全部放入新组件

### 稳定依赖原则
> 依赖关系必须要指向更稳定的方向

#### 稳定性
* 稳定性与变更所需的工作量有关

#### 稳定性的指标
* Fan-in: 入向依赖,这个指标指代了组件外部类依赖于组件内部类的数量
* Fan-out: 出向依赖,这个指标指代了组件内部类依赖于组件外部类的数量
* I: 不稳定性 I=Fan-out/(Fan-in+Fan-out)
    * I=0,意味着组件是稳定的
    * I=1, 意味着组件是最不稳定的

#### 并不是所有组件都应该是稳定的
* 如果一个系统中所有的组件都处于最高稳定性状态,那么系统就一定无法再进行变更了

### SAP 稳定抽象原则
> 一个组件的抽象化程度应该与其稳定性保持一致

* 要求稳定的组件同时应该是抽象的,这样它的稳定性就不会影响到扩展性
* 要求一个不稳定的组件应该包含具体的实现代码,这样它的不稳定性就可以通过具体的代码被轻易修改

#### 衡量抽象化程度
* Nc: 组件中类的数量
* Na: 组件中抽象类和接口的数量
* A: 抽象程度, A=Na/Nc
  * A指标的取值范围是从0到1,值为0代表组件中没有任何抽象类,值为1就意味组件中只有抽象类

![image](https://user-images.githubusercontent.com/13389058/162605331-27f0de86-d529-4e96-91be-30929b2db8b5.png)



